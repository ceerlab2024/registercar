<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>แบบยื่นคำร้องขอขึ้นรถรับ–ส่ง ประจำทาง วิทยาลัยเทคโนโลยีพังโคนพณิชยการ</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;700&display=swap" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
<style>
  :root{ --ink:#000; --accent:#0d6efd; }
  html,body{ font-family:"Sarabun",system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif; color:var(--ink); }

  /* ===== Layout for A4 print ===== */
  @page { size: A4; margin: 14mm; }
  .a4-sheet { width: 210mm; min-height: 297mm; background:#fff; margin:0 auto; padding: 0 11mm; box-sizing:border-box; }
  .doc { font-size: 12pt; line-height: 1.4; }
  .doc h1 { font-size: 18pt; font-weight:700; text-align:center; margin: 8mm 0 2mm; }
  .doc h2 { font-size: 13pt; font-weight:700; margin: 6mm 0 2mm; }
  .doc p { margin: 0 0 2.2mm; text-align: justify; text-justify: inter-word; }
  .t-center{ text-align:center; }
  .t-right{ text-align:right; }
  .mt-2mm{ margin-top:2mm; }
  .mt-4mm{ margin-top:4mm; }
  .mb-2mm{ margin-bottom:1mm; }

  /* Inline fill areas (underline style, no dots) */
  .fill { display:inline-block; min-width: 35mm; border-bottom: 1px solid #000; padding: 0 1mm 1mm 1mm; margin: 0 1mm; white-space:nowrap; text-align:center; line-height: 1.5; vertical-align: baseline; }
  .fill.sm { min-width: 18mm; }
  .fill.md { min-width: 28mm; }
  .fill.lg { min-width: 55mm; }
  .fill.xl { min-width: 85mm; }

  /* Signature block */
  .sig-block { width: 78mm; text-align:center; margin: 6mm auto 0; }
  .sig-line { border-bottom:1px solid #000; height:10mm; }
  .sig-caption { margin-top:1.8mm; }

  /* Table-like two-column rows without borders */
  .rowline { display:flex; gap: 2.0mm; align-items:baseline; flex-wrap:wrap; }
  .rowline .label { white-space:nowrap; }

  /* Consent box */
  .consent-box{ border:1px solid #000; padding:4mm; margin-top:4mm; }

  /* Top input UI (screen only) */
  .ui { position:sticky; top:0; z-index:10; background:linear-gradient(0deg, #e7f1ff, #f8fbff); border-bottom: 1px solid #dbe7ff; }
  .ui .card { border: 1px solid #cfe2ff; box-shadow: 0 6px 16px rgba(13,110,253,.08); }
  .ui .card-header { background: var(--accent); color:#fff; }
  .btn-print { white-space:nowrap; }

  /* Ensure black-and-white output */
  @media print {
    body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    .ui { display:none !important; }
    .a4-sheet { box-shadow:none; }
  }
/* Responsive tuning for input UI only (keeps A4 print layout intact) */
  .ui .container{ max-width: 980px; }
  .ui .form-control, .ui .form-select{ min-height: 42px; }
  @media (max-width: 768px){
    .ui .container{ padding-left: 10px; padding-right: 10px; }
  }
  @media (max-width: 576px){
    .ui .form-control, .ui .form-select{ min-height: 44px; }
  }
.title-big{ font-size: 18pt; font-weight: 700; }
.doc-header{ position: relative; min-height: 28mm; }
  .doc-header .logo{ position:absolute; left:0; top:0; width:24mm; height:24mm; object-fit:contain; }
  .doc-header .top-right{ margin-left: 30mm; }
</style>
</head>
<body>

<!-- ===== Screen UI (blue theme with icons) ===== -->
<section class="ui py-3">
  <div class="container">
    <div class="card">
      <div class="card-header d-flex align-items-center gap-2">
        <i class="bi bi-bus-front-fill me-1"></i>
        <strong>กรอกข้อมูลแบบยื่นคำร้องขึ้นรถรับ–ส่ง</strong>
        <span class="ms-auto small opacity-75">วิทยาลัยเทคโนโลยีพังโคนพณิชยการ</span>
      </div>
      <div class="card-body">
        <div class="row g-3">
          <div class="col-md-3">
            <label class="form-label"><i class="bi bi-calendar3 me-1"></i>วัน</label>
            <input type="text" class="form-control" id="day" placeholder="เช่น 24" disabled>
          </div>
          <div class="col-md-5">
            <label class="form-label"><i class="bi bi-calendar2-month me-1"></i>เดือน</label>
            <input type="text" class="form-control" id="month" placeholder="เช่น ตุลาคม" disabled>
          </div>
          <div class="col-md-4">
            <label class="form-label"><i class="bi bi-calendar2-event me-1"></i>พ.ศ.</label>
            <input type="text" class="form-control" id="year" placeholder="เช่น 2568" disabled>
          </div>

          <div class="col-md-4">
            <label class="form-label"><i class="bi bi-person me-1"></i>คำนำหน้า</label>
            <select id="prefix" class="form-select">
              <option value="นาย">นาย</option>
              <option value="นาง">นาง</option>
              <option value="นางสาว">นางสาว</option>
            </select>
          </div>
          <div class="col-md-8">
            <label class="form-label"><i class="bi bi-person-vcard me-1"></i>ชื่อ–สกุล นักเรียน/นักศึกษา</label>
            <input type="text" class="form-control" id="student_name" placeholder="ชื่อ–สกุล">
          </div>
          <div class="col-md-6">
            <label class="form-label"><i class="bi bi-upc-scan me-1"></i>รหัสประจำตัว</label>
            <input type="text" class="form-control" id="student_id" placeholder="เช่น 20132">
          </div>
          <div class="col-md-6">
            <label class="form-label"><i class="bi bi-geo-alt me-1"></i>เขียนที่</label>
            <input type="text" class="form-control" id="place" value="วิทยาลัยเทคโนโลยีพังโคนพณิชยการ" disabled>
          </div>

          <div class="col-md-6">
            <label class="form-label"><i class="bi bi-tag me-1"></i>ประเภทวิชา</label>
            <select id="program_type" class="form-select">
              <option value="บริหารธุรกิจ">บริหารธุรกิจ</option>
              <option value="ช่างอุตสาหกรรม">ช่างอุตสาหกรรม</option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label"><i class="bi bi-diagram-3 me-1"></i>สาขาวิชา</label>
            <select id="major" class="form-select">
              <option>สาขาการบัญชี</option>
              <option>สาขาภาษาต่างประเทศ</option>
              <option>สาขาเทคโนโลยีธุรกิจดิจิทัล</option>
              <option>สาขาการโรงแรม</option>
              <option>สาขาช่างยนต์</option>
              <option>สาขาไฟฟ้า</option>
              <option>สาขาอิเลกทรอนิกส์</option>
              <option>สาขาการจัดการธุรกิจค้าปลีก</option>
              <option>สาขาการจัดการโลจิสติกส์</option>
            </select>
          </div>

          <div class="col-md-6">
            <label class="form-label"><i class="bi bi-diagram-2 me-1"></i>สาขางาน(ถ้ามี)</label>
            <input type="text" id="minor" class="form-control" placeholder="สาขางาน (ถ้ามี)">
          </div>
          <div class="col-md-3">
            <label class="form-label"><i class="bi bi-123 me-1"></i>ระดับชั้น</label>
            <input type="text" id="level" class="form-control" placeholder="เช่น ปวช.2">
          </div>
          <div class="col-md-3">
            <label class="form-label"><i class="bi bi-door-open me-1"></i>ห้อง</label>
            <input type="text" id="room" class="form-control" placeholder="เช่น 1">
          </div>

          <div class="col-md-6">
            <label class="form-label"><i class="bi bi-telephone me-1"></i>เบอร์โทรนักเรียน</label>
            <input type="text" id="student_tel" class="form-control" placeholder="เบอร์โทร">
          </div>
          <div class="col-md-6">
            <label class="form-label"><i class="bi bi-telephone-outbound me-1"></i>เบอร์โทรผู้ปกครอง</label>
            <input type="text" id="parent_tel" class="form-control" placeholder="เบอร์โทรผู้ปกครอง">
          </div>

          <div class="col-md-12">
            <label class="form-label"><i class="bi bi-signpost me-1"></i>ต้นทาง (บ้าน/หมู่บ้าน/เลขที่)</label>
            <input type="text" id="addr_home" class="form-control" placeholder="กรอกชื่อบ้าน/หมู่บ้าน/เลขที่">
          </div>
          <div class="col-md-4">
            <label class="form-label">ตำบล</label>
            <input type="text" id="addr_tambon" class="form-control">
          </div>
          <div class="col-md-4">
            <label class="form-label">อำเภอ</label>
            <input type="text" id="addr_amphur" class="form-control">
          </div>
          <div class="col-md-4">
            <label class="form-label">จังหวัด</label>
            <input type="text" id="addr_province" class="form-control" value="สกลนคร">
          </div>

          <div class="col-12"><hr class="my-2"></div>

          <div class="col-md-5">
            <label class="form-label"><i class="bi bi-person-lines-fill me-1"></i>ผู้ปกครอง (คำนำหน้า)</label>
            <select id="parent_prefix" class="form-select">
              <option value="นาย">นาย</option>
              <option value="นาง">นาง</option>
              <option value="นางสาว">นางสาว</option>
            </select>
          </div>
          <div class="col-md-7">
            <label class="form-label">ชื่อ–สกุล ผู้ปกครอง</label>
            <input type="text" id="parent_name" class="form-control" placeholder="ชื่อ–สกุลผู้ปกครอง">
          </div>
          <div class="col-md-6">
            <label class="form-label"><i class="bi bi-people me-1"></i>ความเกี่ยวข้อง</label>
            <select id="relation" class="form-select">
              <option value="บิดา">บิดา</option>
              <option value="มารดา">มารดา</option>
              <option value="อื่น ๆ">อื่น ๆ (ระบุด้านขวา)</option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label">ระบุความเกี่ยวข้อง (ถ้าเลือก "อื่น ๆ")</label>
            <input type="text" id="relation_other" class="form-control" placeholder="เช่น ปู่/ย่า/ผู้ดูแล">
          </div>
        </div>

        <div class="d-flex gap-2 mt-3">
          <button class="btn btn-primary btn-print" onclick="window.print()"><i class="bi bi-filetype-pdf me-1"></i>พิมพ์/บันทึก PDF (A4)</button>
          <button class="btn btn-outline-secondary" id="btn-clear"><i class="bi bi-eraser me-1"></i>ล้างข้อมูลที่กรอก</button>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- ===== Printable Document ===== -->
<section class="a4-sheet">
  <div class="doc">
    <div class="doc-header">
      <img class="logo" src="https://github.com/ceerlab2024/registercar/blob/main/images/logo%20non%20back.png?raw=true" alt="โลโก้วิทยาลัย">
      <div class="top-right">
        <p class="t-right mb-2mm">เขียนที่ <strong>วิทยาลัยเทคโนโลยีพังโคนพณิชยการ</strong></p>
        <p class="t-right">วันที่ <span class="fill sm" data-bind="day"></span> เดือน <span class="fill md" data-bind="month"></span> พ.ศ. <span class="fill sm" data-bind="year"></span></p>
      </div>
    </div>

    <center><h3><b>แบบยื่นคำร้องประสงค์ขอขึ้นรถรับ–ส่ง ประจำทาง</b></h3></center>
    <center><h3><b>วิทยาลัยเทคโนโลยีพังโคนพณิชยการ</b></h3></center>

    <p>เรื่อง แจ้งความประสงค์ขอขึ้นรถรับ–ส่ง ประจำทางภาคเรียนที่ <strong>2/2568</strong></p>
    <p>เรียน ผู้อำนวยการวิทยาลัยเทคโนโลยีพังโคนพณิชยการ</p>

    <p>ด้วยข้าพเจ้า <span class="fill xl" data-bind="prefixName"></span> รหัสประจำตัว <span class="fill md" data-bind="student_id"></span></p>

    <div class="rowline">
      <span class="label">ประเภทวิชา</span>
      <span class="fill md" data-bind="program_type"></span>
      <span class="label">สาขาวิชา</span>
      <span class="fill lg" data-bind="major"></span>
      <span class="label">สาขางาน</span>
      <span class="fill lg" data-bind="minor"></span>
      <span class="label">ระดับชั้น</span>
      <span class="fill sm" data-bind="level"></span>
    </div>

    <div class="rowline mt-2mm">
      <span class="label">ห้อง</span>
      <span class="fill sm" data-bind="room"></span>
      <span class="label">เบอร์โทรนักเรียน</span>
      <span class="fill md" data-bind="student_tel"></span>
      <span class="label">เบอร์โทรผู้ปกครอง</span>
      <span class="fill md" data-bind="parent_tel"></span>
    </div>

    <p class="mt-2mm">มีความประสงค์ขอขึ้นรถรับ–ส่งไป–กลับ ประจำทางของวิทยาลัยฯ ในภาคเรียนที่ <strong>2/2568</strong>
      (ระหว่างเดือน พฤศจิกายน 2568 – มีนาคม 2569) ขึ้นรถโดยสารไป–กลับ จากจุดเริ่มต้น
      บ้าน <span class="fill lg" data-bind="addr_home"></span>
      ตำบล <span class="fill md" data-bind="addr_tambon"></span>
      อำเภอ <span class="fill md" data-bind="addr_amphur"></span>
      จังหวัด <span class="fill md" data-bind="addr_province"></span>
      ถึงวิทยาลัยเทคโนโลยีพังโคนพณิชยการ โดยยินยอมชำระค่าโดยสารประจำทางตามอัตราระยะทางที่วิทยาลัยฯ กำหนด
      ทุกวันที่ 25 ของเดือน</p>

    <p class="mt-4mm">จึงเรียนมาเพื่อโปรดพิจารณาอนุมัติ</p>

    <!-- Signature: Student (3 lines) -->
    <div class="sig-block">
      <div class="d-flex align-items-end gap-2">
        <div class="flex-grow-1 sig-line"></div>
        <div class="small">นักเรียน/นักศึกษา</div>
      </div>
      <div class="sig-caption">( <span data-bind="student_name"></span> )</div>
      <div class="sig-caption">วันที่ <span class="fill sm" data-bind="day"></span>/<span class="fill sm" data-bind="month"></span>/<span class="fill sm" data-bind="year"></span></div>
    </div>

    <div class="consent-box">
      <h2 class="mt-4mm">1. คำยินยอมของผู้ปกครอง นักเรียน/นักศึกษา</h2>

      <p>ข้าพเจ้า <span class="fill xl" data-bind="parent_prefix_name"></span> เกี่ยวข้องเป็น
        <span class="fill md" data-bind="relation_display"></span>
        ยินยอมให้นักเรียน/นักศึกษา <span class="fill xl" data-bind="prefixName"></span>
        รหัสประจำตัว <span class="fill md" data-bind="student_id"></span>
        ขอขึ้นรถรับ–ส่ง ประจำทางภาคเรียนที่ <strong>2/2568</strong>
        โดยยินยอมชำระค่าโดยสารประจำทางตามอัตราระยะทางที่วิทยาลัยฯ กำหนด ทุกวันที่ 25 ของเดือน</p>

      <!-- Signature: Parent (3 lines) -->
      <div class="sig-block">
        <div class="d-flex align-items-end gap-2">
          <div class="flex-grow-1 sig-line"></div>
          <div class="small">ผู้ปกครอง</div>
        </div>
        <div class="sig-caption">( <span data-bind="parent_name"></span> )</div>
        <div class="sig-caption">วันที่ <span class="fill sm" data-bind="day"></span>/<span class="fill sm" data-bind="month"></span>/<span class="fill sm" data-bind="year"></span></div>
      </div>
    </div>

    <div class="mt-4mm"></div>
  </div>
</section>

<script>
(function(){
  // ---- Auto fill current Thai date (Bangkok timezone); fields are locked (disabled) ----
  try{
    const now = new Date(new Date().toLocaleString('en-US',{timeZone:'Asia/Bangkok'}));
    const thMonths = ['มกราคม','กุมภาพันธ์','มีนาคม','เมษายน','พฤษภาคม','มิถุนายน','กรกฎาคม','สิงหาคม','กันยายน','ตุลาคม','พฤศจิกายน','ธันวาคม'];
    const d = String(now.getDate());
    const m = thMonths[now.getMonth()];
    const y = String(now.getFullYear()+543);
    const dayEl = document.getElementById('day');
    const monthEl = document.getElementById('month');
    const yearEl = document.getElementById('year');
    if(dayEl && !dayEl.value) dayEl.value = d;
    if(monthEl && !monthEl.value) monthEl.value = m;
    if(yearEl && !yearEl.value) yearEl.value = y;
  }catch(e){}

  const $ = (sel) => document.querySelector(sel);

  function setBind(key, value){
    const display = (value && String(value).trim().length) ? value : '-';
    document.querySelectorAll('[data-bind="'+key+'"]').forEach(el=>{ el.textContent = display; });
  }
  function getVal(id){ return (document.getElementById(id)?.value || "").trim(); }

  // Map inputs -> binds
  const map = [
    ['day','day'],
    ['month','month'],
    ['year','year'],
    ['student_id','student_id'],
    ['student_name','student_name'],
    ['program_type','program_type'],
    ['major','major'],
    ['minor','minor'],
    ['level','level'],
    ['room','room'],
    ['student_tel','student_tel'],
    ['parent_tel','parent_tel'],
    ['addr_home','addr_home'],
    ['addr_tambon','addr_tambon'],
    ['addr_amphur','addr_amphur'],
    ['addr_province','addr_province'],
    ['parent_name','parent_name']
  ];

  // Compound fields
  function updatePrefixName(){
    const px = getVal('prefix');
    const nm = getVal('student_name');
    setBind('prefixName', (px && nm) ? (px+" "+nm) : "");
  }
  function updateParentPrefixName(){
    const ppx = getVal('parent_prefix');
    const pnm = getVal('parent_name');
    setBind('parent_prefix_name', (ppx && pnm) ? (ppx+" "+pnm) : "");
  }
  function updateRelationDisplay(){
    const rel = getVal('relation');
    const other = getVal('relation_other');
    setBind('relation_display', rel === 'อื่น ๆ' ? other : rel);
  }

  // Attach listeners
  map.forEach(([id,key])=>{
    const el = document.getElementById(id);
    if(!el) return;
    el.addEventListener('input', ()=> setBind(key, getVal(id)) );
    setBind(key, getVal(id));
  });
  ['prefix','student_name'].forEach(id=>{ const el = document.getElementById(id); el.addEventListener('input', updatePrefixName); });
  ['parent_prefix','parent_name'].forEach(id=>{ const el = document.getElementById(id); el.addEventListener('input', updateParentPrefixName); });
  ['relation','relation_other'].forEach(id=>{ const el = document.getElementById(id); el.addEventListener('input', updateRelationDisplay); });

  // Lock/unlock relation other field
  function toggleRelationOther(){
    const relSel = document.getElementById('relation');
    const other = document.getElementById('relation_other');
    if(relSel && other){
      const v = relSel.value;
      const lock = (v==='บิดา' || v==='มารดา');
      other.disabled = lock;
      if(lock){ other.value = ''; }
      updateRelationDisplay();
    }
  }
  document.getElementById('relation').addEventListener('change', toggleRelationOther);
  document.getElementById('relation').addEventListener('input', toggleRelationOther);
  document.getElementById('relation_other').addEventListener('input', ()=>{
    setBind('relation_display', getVal('relation')==='อื่น ๆ' ? getVal('relation_other') : getVal('relation'));
  });
  toggleRelationOther();

  // Address inputs manual: bind to document
  ['addr_province','addr_amphur','addr_tambon'].forEach(id=>{
    const el=document.getElementById(id);
    if(el){ el.addEventListener('input', ()=> setBind(id, getVal(id)) ); setBind(id, getVal(id)); }
  });

  // Clear button
  $('#btn-clear').addEventListener('click', function(){
    document.querySelectorAll('.ui input:not([disabled])').forEach(inp=> { inp.value = ''; inp.dispatchEvent(new Event('input')); });
    document.querySelectorAll('.ui select').forEach(sel=>{ sel.selectedIndex = -1; sel.dispatchEvent(new Event('input')); });
    // Re-bind to '-' for all
    ['day','month','year','student_id','student_name','program_type','major','minor','level','room','student_tel','parent_tel','addr_home','addr_tambon','addr_amphur','addr_province','parent_name','prefixName','parent_prefix_name','relation_display']
      .forEach(k=> setBind(k, ''));
    toggleRelationOther();
  });
})();
</script>
</body>
</html>
